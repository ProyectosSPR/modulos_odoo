<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- RFC -->
        <record id="csf_field_rfc" model="billing.csf.field.config">
            <field name="name">RFC</field>
            <field name="field_type">rfc</field>
            <field name="odoo_field">vat</field>
            <field name="regex_pattern">RFC:\s*([A-ZÑ&amp;]{3,4}\d{6}[A-Z0-9]{3})</field>
            <field name="alternative_patterns">Registro Federal de Contribuyentes:\s*([A-ZÑ&amp;]{3,4}\d{6}[A-Z0-9]{3})
Clave del RFC:\s*([A-ZÑ&amp;]{3,4}\d{6}[A-Z0-9]{3})
([A-ZÑ&amp;]{3,4}\d{6}[A-Z0-9]{3})\s*RFC</field>
            <field name="validation_regex">^[A-ZÑ&amp;]{3,4}\d{6}[A-Z0-9]{3}$</field>
            <field name="error_message">El RFC no tiene un formato válido</field>
            <field name="transformation">uppercase</field>
            <field name="is_required">True</field>
            <field name="sequence">10</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">rfc</field>
        </record>

        <!-- Razón Social / Nombre -->
        <record id="csf_field_razon_social" model="billing.csf.field.config">
            <field name="name">Razón Social</field>
            <field name="field_type">text</field>
            <field name="odoo_field">name</field>
            <field name="regex_pattern">(?:Denominación|Razón Social|Nombre)[\s:]+([A-ZÁÉÍÓÚÑ\s.,&amp;]+?)(?:\n|RFC|Régimen)</field>
            <field name="alternative_patterns">Nombre.*?:\s*(.+?)(?:\n|$)
Denominación/Razón Social:\s*(.+?)(?:\n|RFC)</field>
            <field name="transformation">strip</field>
            <field name="is_required">True</field>
            <field name="sequence">20</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">razon_social</field>
        </record>

        <!-- Código Postal -->
        <record id="csf_field_codigo_postal" model="billing.csf.field.config">
            <field name="name">Código Postal</field>
            <field name="field_type">postal_code</field>
            <field name="odoo_field">zip</field>
            <field name="regex_pattern">(?:Código Postal|C\.?P\.?)[\s:]+(\d{5})</field>
            <field name="alternative_patterns">CP:\s*(\d{5})
(\d{5})\s*(?:México|MX)</field>
            <field name="validation_regex">^\d{5}$</field>
            <field name="error_message">El código postal debe tener 5 dígitos</field>
            <field name="transformation">digits_only</field>
            <field name="is_required">True</field>
            <field name="sequence">30</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">codigo_postal</field>
        </record>

        <!-- Régimen Fiscal -->
        <record id="csf_field_regimen_fiscal" model="billing.csf.field.config">
            <field name="name">Régimen Fiscal</field>
            <field name="field_type">catalog</field>
            <field name="odoo_field">l10n_mx_edi_fiscal_regime</field>
            <field name="regex_pattern">Régimen(?:es)?(?:\s+Fiscal(?:es)?)?[\s:]+(\d{3})\s*[-–]\s*(.+?)(?:\n|$)</field>
            <field name="alternative_patterns">(\d{3})\s*[-–]\s*(?:Régimen|Personas|Actividades|Ingresos).+?(?:\n|$)
Régimen:\s*(\d{3})</field>
            <field name="transformation">none</field>
            <field name="is_required">True</field>
            <field name="sequence">40</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">regimen_fiscal</field>
        </record>

        <!-- Entidad Federativa (Estado) -->
        <record id="csf_field_entidad" model="billing.csf.field.config">
            <field name="name">Entidad Federativa</field>
            <field name="field_type">text</field>
            <field name="odoo_field">state_id</field>
            <field name="regex_pattern">(?:Entidad Federativa|Estado)[\s:]+([A-ZÁÉÍÓÚÑ\s]+?)(?:\n|,|Municipio)</field>
            <field name="alternative_patterns">(?:CDMX|Ciudad de México|Jalisco|Nuevo León|Estado de México|Veracruz|Puebla|Guanajuato|Chihuahua|Michoacán|Oaxaca|Chiapas|Guerrero|Tamaulipas|Baja California|Sinaloa|Coahuila|Sonora|Hidalgo|San Luis Potosí|Tabasco|Yucatán|Querétaro|Morelos|Durango|Zacatecas|Quintana Roo|Aguascalientes|Tlaxcala|Nayarit|Campeche|Colima|Baja California Sur)</field>
            <field name="transformation">strip</field>
            <field name="is_required">False</field>
            <field name="sequence">50</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">entidad_federativa</field>
        </record>

        <!-- Municipio -->
        <record id="csf_field_municipio" model="billing.csf.field.config">
            <field name="name">Municipio / Alcaldía</field>
            <field name="field_type">text</field>
            <field name="odoo_field">city</field>
            <field name="regex_pattern">(?:Municipio|Alcaldía|Delegación)[\s:]+([A-ZÁÉÍÓÚÑ\s]+?)(?:\n|,|Localidad|Colonia)</field>
            <field name="transformation">strip</field>
            <field name="is_required">False</field>
            <field name="sequence">60</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">municipio</field>
        </record>

        <!-- Colonia -->
        <record id="csf_field_colonia" model="billing.csf.field.config">
            <field name="name">Colonia</field>
            <field name="field_type">text</field>
            <field name="odoo_field">l10n_mx_edi_colony</field>
            <field name="regex_pattern">(?:Colonia|Col\.)[\s:]+([A-ZÁÉÍÓÚÑ\s0-9]+?)(?:\n|,|Calle|C\.P\.)</field>
            <field name="transformation">strip</field>
            <field name="is_required">False</field>
            <field name="sequence">70</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">colonia</field>
        </record>

        <!-- Calle -->
        <record id="csf_field_calle" model="billing.csf.field.config">
            <field name="name">Calle</field>
            <field name="field_type">text</field>
            <field name="odoo_field">street</field>
            <field name="regex_pattern">(?:Calle|Nombre de Vialidad)[\s:]+([A-ZÁÉÍÓÚÑ\s0-9.]+?)(?:\n|,|No\.|Núm|Número)</field>
            <field name="transformation">strip</field>
            <field name="is_required">False</field>
            <field name="sequence">80</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">calle</field>
        </record>

        <!-- Número Exterior -->
        <record id="csf_field_num_ext" model="billing.csf.field.config">
            <field name="name">Número Exterior</field>
            <field name="field_type">text</field>
            <field name="odoo_field">street_number</field>
            <field name="regex_pattern">(?:No\.\s*Exterior|Núm\.\s*Exterior|Número Exterior)[\s:]+([A-Z0-9\-]+)</field>
            <field name="alternative_patterns">Exterior[\s:]+(\d+[A-Z]?)
No\.\s*Ext\.?[\s:]+([A-Z0-9\-]+)</field>
            <field name="transformation">strip</field>
            <field name="is_required">False</field>
            <field name="sequence">90</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">numero_exterior</field>
        </record>

        <!-- Número Interior -->
        <record id="csf_field_num_int" model="billing.csf.field.config">
            <field name="name">Número Interior</field>
            <field name="field_type">text</field>
            <field name="odoo_field">street2</field>
            <field name="regex_pattern">(?:No\.\s*Interior|Núm\.\s*Interior|Número Interior)[\s:]+([A-Z0-9\-]+)</field>
            <field name="alternative_patterns">Interior[\s:]+(\d+[A-Z]?)
No\.\s*Int\.?[\s:]+([A-Z0-9\-]+)</field>
            <field name="transformation">strip</field>
            <field name="is_required">False</field>
            <field name="sequence">100</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">numero_interior</field>
        </record>

        <!-- Fecha de Inicio de Operaciones -->
        <record id="csf_field_fecha_inicio" model="billing.csf.field.config">
            <field name="name">Fecha Inicio Operaciones</field>
            <field name="field_type">date</field>
            <field name="odoo_field"></field>
            <field name="regex_pattern">(?:Fecha de Inicio de Operaciones|Inicio de operaciones)[\s:]+(\d{1,2}[\s/\-]\w+[\s/\-]\d{4}|\d{4}[\s/\-]\d{2}[\s/\-]\d{2})</field>
            <field name="transformation">none</field>
            <field name="is_required">False</field>
            <field name="sequence">110</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">fecha_inicio_operaciones</field>
        </record>

        <!-- Estatus en el Padrón -->
        <record id="csf_field_estatus" model="billing.csf.field.config">
            <field name="name">Estatus en el Padrón</field>
            <field name="field_type">text</field>
            <field name="odoo_field"></field>
            <field name="regex_pattern">(?:Estatus en el padrón|Situación del contribuyente)[\s:]+(\w+)</field>
            <field name="alternative_patterns">(?:ACTIVO|CANCELADO|SUSPENDIDO)</field>
            <field name="transformation">uppercase</field>
            <field name="is_required">False</field>
            <field name="sequence">120</field>
            <field name="use_ai_extraction">True</field>
            <field name="ai_json_path">estatus_padron</field>
        </record>
    </data>
</odoo>
