<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Template base del portal de facturación -->
    <template id="portal_layout" name="Billing Portal Layout">
        <t t-call="website.layout">
            <div id="wrap" class="billing-portal-wrap">
                <!-- Header del Portal -->
                <header class="billing-portal-header bg-primary text-white py-3">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-md-6">
                                <h1 class="h4 mb-0">
                                    <i class="fa fa-file-invoice-dollar me-2"></i>
                                    Portal de Facturación
                                </h1>
                            </div>
                            <div class="col-md-6 text-md-end">
                                <t t-if="user_data">
                                    <span class="me-3">
                                        <i class="fa fa-user me-1"></i>
                                        <t t-esc="user_data.get('nombre') or user_data.get('email', 'Usuario')"/>
                                    </span>
                                    <a href="/portal/billing/logout" class="btn btn-outline-light btn-sm">
                                        <i class="fa fa-sign-out-alt"></i> Salir
                                    </a>
                                </t>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Navegación -->
                <nav class="billing-portal-nav bg-light border-bottom" t-if="user_data">
                    <div class="container">
                        <ul class="nav nav-pills py-2">
                            <li class="nav-item">
                                <a class="nav-link" href="/portal/billing/orders"
                                   t-att-class="'nav-link active' if page_title == 'Mis Órdenes' else 'nav-link'">
                                    <i class="fa fa-shopping-cart me-1"></i> Mis Órdenes
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/portal/billing/history"
                                   t-att-class="'nav-link active' if page_title == 'Historial de Solicitudes' else 'nav-link'">
                                    <i class="fa fa-history me-1"></i> Historial
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>

                <!-- Contenido principal -->
                <main class="billing-portal-content py-4">
                    <div class="container">
                        <t t-raw="0"/>
                    </div>
                </main>

                <!-- Footer -->
                <footer class="billing-portal-footer bg-dark text-white py-4 mt-auto">
                    <div class="container text-center">
                        <p class="mb-0">
                            <small>Portal de Facturación - DML Médica</small>
                        </p>
                    </div>
                </footer>
            </div>
        </t>
    </template>

    <!-- Template de error genérico -->
    <template id="portal_error" name="Portal Error">
        <t t-call="billing_portal.portal_layout">
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <div class="card border-danger">
                        <div class="card-header bg-danger text-white">
                            <h5 class="mb-0">
                                <i class="fa fa-exclamation-triangle me-2"></i>
                                <t t-esc="error_title or 'Error'"/>
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text">
                                <t t-esc="error_message or 'Ha ocurrido un error'"/>
                            </p>
                            <a href="/portal/billing/orders" class="btn btn-primary">
                                <i class="fa fa-arrow-left me-1"></i> Volver
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>
