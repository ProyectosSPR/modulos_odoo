<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Template de Email: Confirmación de Conexión -->
        <record id="mail_template_connected" model="mail.template">
            <field name="name">ML: Confirmación de Cuenta Conectada</field>
            <field name="model_id" ref="model_mercadolibre_invitation"/>
            <field name="subject">✓ Tu cuenta de Mercado Libre ha sido conectada</field>
            <field name="email_from">${(object.company_id.email or user.email_formatted) | safe}</field>
            <field name="email_to">${object.email}</field>
            <field name="body_html" type="html"><![CDATA[
<table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #F1F1F1; font-family:Verdana, Arial,sans-serif; color: #555; width: 100%; border-collapse:separate;">
    <tr>
        <td align="center">
            <table border="0" cellpadding="0" cellspacing="0" width="600" style="padding: 16px; background-color: white; border: 1px solid #e0e0e0;">
                <tr>
                    <td align="center" style="padding: 20px 0;">
                        <img src="/logo.png" style="max-height: 60px;" alt="${object.company_id.name}"/>
                    </td>
                </tr>
                <tr>
                    <td align="center" style="padding: 20px;">
                        <div style="width: 80px; height: 80px; background-color: #28a745; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center;">
                            <span style="color: white; font-size: 48px;">✓</span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td align="center" style="padding: 20px;">
                        <h2 style="color: #333; margin: 0 0 10px 0;">¡Cuenta Conectada Exitosamente!</h2>
                        <p style="font-size: 16px; line-height: 1.6; color: #555;">
                            Tu cuenta de Mercado Libre <strong>${object.account_id.nickname}</strong>
                            ha sido conectada correctamente a <strong>${object.company_id.name}</strong>.
                        </p>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 20px; background-color: #f9f9f9;">
                        <h3 style="color: #333; margin: 0 0 15px 0; font-size: 16px;">Detalles de la Conexión:</h3>
                        <table width="100%" style="font-size: 14px; color: #666;">
                            <tr>
                                <td style="padding: 8px 0;"><strong>Nickname:</strong></td>
                                <td>${object.account_id.nickname}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0;"><strong>ID Usuario:</strong></td>
                                <td>${object.account_id.ml_user_id}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0;"><strong>Sitio:</strong></td>
                                <td>${object.account_id.site_id}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0;"><strong>Conectada el:</strong></td>
                                <td>${format_datetime(object.completed_at, tz='America/Mexico_City', dt_format='dd/MM/yyyy HH:mm')}</td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 20px;">
                        <h3 style="color: #333; margin: 0 0 15px 0; font-size: 16px;">Próximos Pasos:</h3>
                        <ul style="font-size: 14px; color: #666; line-height: 1.8;">
                            <li>Tus órdenes comenzarán a sincronizarse automáticamente</li>
                            <li>El token se refrescará cada 30 minutos de forma automática</li>
                            <li>Puedes gestionar tu cuenta desde Odoo</li>
                            <li>Contacta a tu administrador si necesitas ayuda</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td align="center" style="padding: 20px; border-top: 1px solid #e0e0e0; font-size: 12px; color: #999;">
                        <p style="margin: 0;">
                            Gracias por usar <strong>${object.company_id.name}</strong><br/>
                            Powered by <a href="https://www.odoo.com" style="color: #875A7B;">Odoo</a>
                        </p>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
            ]]></field>
        </record>
    </data>
</odoo>
